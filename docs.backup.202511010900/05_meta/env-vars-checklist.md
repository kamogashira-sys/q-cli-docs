# 環境変数確認チェックリスト

**最終更新**: 2025-10-27  
**目的**: ドキュメント内の環境変数記述の正確性を確保

---

## ✅ 基本確認項目

### 1. 環境変数名の正確性

- [ ] 環境変数名が正しいか（大文字・アンダースコア）
- [ ] プレフィックスが正しいか（`Q_`で始まる）
- [ ] タイポがないか

**正しい例**:
```bash
Q_TELEMETRY_ENABLED=false
Q_CHAT_MODEL=anthropic.claude-3-5-sonnet-20241022-v2:0
```

**誤った例**:
```bash
q_telemetry_enabled=false  # 小文字
Q-TELEMETRY-ENABLED=false  # ハイフン
TELEMETRY_ENABLED=false    # プレフィックスなし
```

---

### 2. 環境変数の値の形式

- [ ] 真偽値は `true`/`false` （小文字）
- [ ] パスは絶対パスまたは `~` で始まる
- [ ] 数値は単位なしの数字のみ

**正しい例**:
```bash
Q_TELEMETRY_ENABLED=false
Q_CONFIG_PATH=~/.config/amazonq
Q_TIMEOUT=30000
```

**誤った例**:
```bash
Q_TELEMETRY_ENABLED=False  # 大文字
Q_CONFIG_PATH=./config     # 相対パス
Q_TIMEOUT=30s              # 単位付き
```

---

### 3. 環境変数の説明

- [ ] 用途が明確に記載されているか
- [ ] デフォルト値が記載されているか
- [ ] 設定例が記載されているか
- [ ] 影響範囲が記載されているか

---

## 🔍 詳細確認項目

### 4. Q CLI固有の環境変数（19項目）

#### テレメトリー関連
- [ ] `Q_TELEMETRY_ENABLED` - 正しく記載されているか
- [ ] デフォルト値: `true` が記載されているか

#### チャット関連
- [ ] `Q_CHAT_MODEL` - モデル名の形式が正しいか
- [ ] `Q_CHAT_TEMPERATURE` - 範囲（0.0-1.0）が記載されているか
- [ ] `Q_CHAT_MAX_TOKENS` - 数値形式が正しいか

#### Knowledge関連
- [ ] `Q_KNOWLEDGE_ENABLED` - 真偽値が正しいか
- [ ] `Q_KNOWLEDGE_PATH` - パス形式が正しいか

#### MCP関連
- [ ] `Q_MCP_SERVER_*` - サーバー名の形式が正しいか
- [ ] 環境変数展開 `${env:VAR_NAME}` の説明があるか

#### Agent関連
- [ ] `Q_AGENT_NAME` - Agent名の形式が正しいか
- [ ] `Q_AGENT_PATH` - パス形式が正しいか

---

### 5. システム環境変数（4項目）

- [ ] `HOME` - ホームディレクトリの説明が正しいか
- [ ] `PATH` - 実行パスの説明が正しいか
- [ ] `SHELL` - シェルの説明が正しいか
- [ ] `EDITOR` - エディタの説明が正しいか

---

## 🎯 実践的確認項目

### 6. 環境変数の優先順位

- [ ] 優先順位が正しく記載されているか
  1. コマンドライン引数
  2. 環境変数
  3. Agent設定
  4. グローバル設定
  5. デフォルト値

---

### 7. 環境変数展開

- [ ] `${env:VAR_NAME}` 構文が正しく記載されているか
- [ ] 使用可能な場所が明記されているか
  - MCP設定
  - Agent設定
- [ ] 使用例が記載されているか

**正しい例**:
```json
{
  "command": "node",
  "args": ["${env:HOME}/.config/mcp/server.js"]
}
```

---

### 8. セキュリティ関連

- [ ] 機密情報を含む環境変数の取り扱いが記載されているか
- [ ] `.env` ファイルの使用方法が記載されているか
- [ ] `.gitignore` への追加が推奨されているか

---

## 📋 バグ再発防止項目

### 9. 過去のバグパターン

以下のバグが2025-10-27の検証で発見されました。再発防止のため確認してください。

#### パターン1: 環境変数名の誤り
- [ ] 小文字で記載されていないか
- [ ] ハイフンで記載されていないか
- [ ] プレフィックスが欠落していないか

#### パターン2: 値の形式誤り
- [ ] 真偽値が大文字で記載されていないか
- [ ] パスが相対パスで記載されていないか
- [ ] 数値に単位が付いていないか

#### パターン3: 説明の不足
- [ ] デフォルト値が記載されているか
- [ ] 設定例が記載されているか
- [ ] 影響範囲が記載されているか

---

## 🔧 修正時の注意事項

### 10. 修正作業

- [ ] 修正前に元の記述を確認
- [ ] 公式ドキュメントで仕様を確認
- [ ] ソースコードで実装を確認
- [ ] 修正後に動作確認

### 11. 横展開確認

- [ ] 同じ環境変数が他のファイルにも記載されていないか
- [ ] 同じパターンの誤りが他にもないか
- [ ] 関連する設定項目も確認

---

## 📊 チェック結果の記録

### 確認日時
- 確認日: YYYY-MM-DD
- 確認者: 

### 確認結果
- 総確認項目数: 
- 問題発見数: 
- 修正完了数: 

### 発見した問題
1. 
2. 
3. 

---

## 📚 参考資料

### 公式ドキュメント
- [Q CLI 環境変数リファレンス](../01_for-users/07_reference/03_settings-reference.md)
- [設定優先順位ガイド](../01_for-users/03_configuration/07_priority-rules.md)

### 関連チェックリスト
- [設定項目確認チェックリスト](settings-checklist.md)
- [ファイルパス確認チェックリスト](file-paths-checklist.md)

---

**作成日**: 2025-10-27  
**バージョン**: 1.0  
**作成根拠**: 2025-10-27の修正作業で発見されたバグパターンを基に作成
