[ãƒ›ãƒ¼ãƒ ](../README.md) > [Meta](README.md) > ä½œæ¥­åŽŸå‰‡å¼·åˆ¶é©ç”¨ã‚·ã‚¹ãƒ†ãƒ 

---

# ä½œæ¥­åŽŸå‰‡å¼·åˆ¶é©ç”¨ã‚·ã‚¹ãƒ†ãƒ 

**ä½œæˆæ—¥æ™‚**: 2025-10-28 00:23 JST  
**æ›´æ–°æ—¥æ™‚**: 2025-10-28 02:35 JST  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… å®Ÿè£…å®Œäº†ãƒ»å‹•ä½œç¢ºèªæ¸ˆã¿

---

## ðŸ“‹ ç›®æ¬¡

1. [ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦](#ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦)
2. [ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ](#ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ)
3. [ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †](#ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †)
4. [ç¨¼åƒç¢ºèªæ–¹æ³•](#ç¨¼åƒç¢ºèªæ–¹æ³•)
5. [ä½¿ç”¨æ–¹æ³•](#ä½¿ç”¨æ–¹æ³•)
6. [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)

---

## ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦

### ç›®çš„
Q CLI Chatä¸­ã®é‡è¦ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œæ™‚ã«ä½œæ¥­åŽŸå‰‡ã‚’é©ç”¨ã—ã€å“è³ªé‡è¦–ã®ä½œæ¥­ã‚’å¾¹åº•ã™ã‚‹ã€‚

### å®Ÿè£…æ–¹å¼
**ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ + preToolUse Hook** ã®2å±¤æ§‹é€ 

1. **ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**: ä½œæ¥­åŽŸå‰‡ã®å†…åœ¨åŒ–ï¼ˆQ CLIèµ·å‹•æ™‚ï¼‰
2. **preToolUse Hook**: é‡è¦ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œæ™‚ã®ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

### å¯¾è±¡ãƒ„ãƒ¼ãƒ«
- `fs_write` - ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆãƒ»ç·¨é›†
- `execute_bash` - ã‚³ãƒžãƒ³ãƒ‰å®Ÿè¡Œ
- `use_aws` - AWSæ“ä½œ

### å‹•ä½œãƒ•ãƒ­ãƒ¼
```
Q CLIèµ·å‹•
    â†“
ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆé©ç”¨ï¼ˆä½œæ¥­åŽŸå‰‡ã®å†…åœ¨åŒ–ï¼‰
    â†“
é‡è¦ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œæ™‚ï¼ˆfs_write, execute_bash, use_awsï¼‰
    â†“
preToolUse Hookå®Ÿè¡Œï¼ˆç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºï¼‰
    â†“
ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œç¶™ç¶š
```

### ç‰¹å¾´
- âœ… **ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆçµ±åˆ**: Q CLIæ¨™æº–æ©Ÿèƒ½ã‚’æ´»ç”¨
- âœ… **éžã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–**: ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å‹•ä½œ
- âœ… **è»½é‡**: å¹³å‡0.08ç§’ã§é«˜é€Ÿå‹•ä½œ
- âœ… **é¸æŠžçš„**: é‡è¦ãƒ„ãƒ¼ãƒ«ã®ã¿å¯¾è±¡
- âœ… **ä¿å®ˆæ€§**: ã‚·ãƒ³ãƒ—ãƒ«ãªæ§‹æˆã§ç®¡ç†å®¹æ˜“

---

## ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ

### 1. ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ

**ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `~/.amazonq/rules/system-prompt.md`

**å½¹å‰²**: Q CLIèµ·å‹•æ™‚ã«ä½œæ¥­åŽŸå‰‡ã‚’å†…åœ¨åŒ–

**å†…å®¹ä¾‹**:
```markdown
# Q CLIä½œæ¥­åŽŸå‰‡ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ

ã‚ãªãŸã¯ä»¥ä¸‹ã®ä½œæ¥­åŽŸå‰‡ã«åŽ³æ ¼ã«å¾“ã£ã¦ä½œæ¥­ã—ã¾ã™ï¼š

## ä½œæ¥­åŽŸå‰‡

### 1. æ¤œè¨¼ã®å¾¹åº•
- **æŽ¨æ¸¬ç¦æ­¢**: ã€ŒãŸã¶ã‚“ã€ã€ŒãŠãã‚‰ãã€ãªã©ã®æŽ¨æ¸¬è¡¨ç¾ã‚’ä½¿ã‚ãªã„
- **ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ç¢ºèª**: å®Ÿè£…ã«é–¢ã™ã‚‹è³ªå•ã§ã¯å¿…ãšã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèªã™ã‚‹
- **å®Ÿè£…æ¤œè¨¼**: è¨­å®šä¾‹ã‚„æ‰‹é †ã¯å®Ÿéš›ã«å‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹
```

### 2. Agent Hookè¨­å®š

**ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `~/.aws/amazonq/cli-agents/default.json`

**Hookè¨­å®š**:
```json
{
  "name": "default",
  "description": "Default client agent set",
  "prompt": "file:///home/katoh/.amazonq/rules/system-prompt.md",
  "hooks": {
    "preToolUse": [
      {
        "command": "~/.local/bin/smart-work-principles-check",
        "matcher": "fs_write"
      },
      {
        "command": "~/.local/bin/smart-work-principles-check",
        "matcher": "execute_bash"
      },
      {
        "command": "~/.local/bin/smart-work-principles-check",
        "matcher": "use_aws"
      }
    ]
  }
}
```

### 3. Hook ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

**ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**: `~/.local/bin/smart-work-principles-check`

**å†…å®¹**:
```bash
#!/bin/bash

# ç’°å¢ƒå¤‰æ•°ã‹ã‚‰æƒ…å ±å–å¾—
TOOL_NAME="$Q_HOOK_TOOL_NAME"
TRIGGER="$Q_HOOK_TRIGGER"

# ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§ä½œæ¥­åŽŸå‰‡ãŒé©ç”¨ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€
# Hookã§ã¯ç°¡æ½”ãªç¢ºèªã®ã¿å®Ÿè¡Œ
echo "ðŸ” ä½œæ¥­åŽŸå‰‡é©ç”¨ä¸­: $TOOL_NAME å®Ÿè¡Œå‰ãƒã‚§ãƒƒã‚¯å®Œäº†"
```

**æ¨©é™**: å®Ÿè¡Œå¯èƒ½ (`chmod +x`)

### 4. ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§

| ãƒ•ã‚¡ã‚¤ãƒ« | å½¹å‰² | ã‚µã‚¤ã‚º | æ¨©é™ |
|---------|------|--------|------|
| `~/.amazonq/rules/system-prompt.md` | ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ | ~1.6KB | 644 |
| `~/.aws/amazonq/cli-agents/default.json` | Agentè¨­å®š | ~8KB | 644 |
| `~/.local/bin/smart-work-principles-check` | Hook ã‚¹ã‚¯ãƒªãƒ—ãƒˆ | ~295B | 755 |

---

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

### å‰ææ¡ä»¶

- Q CLI v1.19.0ä»¥é™
- Agentè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®æ›¸ãè¾¼ã¿æ¨©é™
- `~/.local/bin`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆæ¨©é™

### ã‚¹ãƒ†ãƒƒãƒ—1: ç¾åœ¨ã®è¨­å®šç¢ºèª

```bash
# Agentè¨­å®šã®ç¢ºèª
jq '.prompt' ~/.aws/amazonq/cli-agents/default.json

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›: ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®ãƒ‘ã‚¹
# "file:///home/user/.amazonq/rules/system-prompt.md"
```

### ã‚¹ãƒ†ãƒƒãƒ—2: Hook ã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ

```bash
# ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
mkdir -p ~/.local/bin

# ã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ
cat > ~/.local/bin/smart-work-principles-check << 'EOF'
#!/bin/bash

# ç’°å¢ƒå¤‰æ•°ã‹ã‚‰æƒ…å ±å–å¾—
TOOL_NAME="$Q_HOOK_TOOL_NAME"
TRIGGER="$Q_HOOK_TRIGGER"

# ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§ä½œæ¥­åŽŸå‰‡ãŒé©ç”¨ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€
# Hookã§ã¯ç°¡æ½”ãªç¢ºèªã®ã¿å®Ÿè¡Œ
echo "ðŸ” ä½œæ¥­åŽŸå‰‡é©ç”¨ä¸­: $TOOL_NAME å®Ÿè¡Œå‰ãƒã‚§ãƒƒã‚¯å®Œäº†"
EOF

# å®Ÿè¡Œæ¨©é™ä»˜ä¸Ž
chmod +x ~/.local/bin/smart-work-principles-check
```

### ã‚¹ãƒ†ãƒƒãƒ—3: Agentè¨­å®šã®æ›´æ–°

**é‡è¦**: Agentè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç›´æŽ¥ç·¨é›†ã—ã¦ãã ã•ã„ã€‚

```bash
# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆ
cp ~/.aws/amazonq/cli-agents/default.json ~/.aws/amazonq/cli-agents/default.json.backup

# è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ï¼ˆæ‰‹å‹•ï¼‰
# hooks.preToolUse ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ 
```

**è¿½åŠ ã™ã‚‹è¨­å®š**:
```json
{
  "hooks": {
    "preToolUse": [
      {
        "command": "~/.local/bin/smart-work-principles-check",
        "matcher": "fs_write"
      },
      {
        "command": "~/.local/bin/smart-work-principles-check",
        "matcher": "execute_bash"
      },
      {
        "command": "~/.local/bin/smart-work-principles-check",
        "matcher": "use_aws"
      }
    ]
  }
}
```

### ã‚¹ãƒ†ãƒƒãƒ—4: Q CLIå†èµ·å‹•

```bash
# æ—¢å­˜ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†
pkill -f qchat

# æ–°ã—ã„ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹
q chat
```

---

## ç¨¼åƒç¢ºèªæ–¹æ³•

### æ–¹æ³•1: Hookè¨­å®šç¢ºèª

```bash
# Hookè¨­å®šã®ç¢ºèª
jq '.hooks.preToolUse' ~/.aws/amazonq/cli-agents/default.json

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
# [
#   {
#     "command": "~/.local/bin/smart-work-principles-check",
#     "matcher": "fs_write"
#   },
#   ...
# ]
```

### æ–¹æ³•2: ã‚¹ã‚¯ãƒªãƒ—ãƒˆå‹•ä½œç¢ºèª

```bash
# ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã—ã¦æ‰‹å‹•å®Ÿè¡Œãƒ†ã‚¹ãƒˆ
Q_HOOK_TOOL_NAME="fs_write" Q_HOOK_TRIGGER="preToolUse" ~/.local/bin/smart-work-principles-check

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
# ðŸ” ä½œæ¥­åŽŸå‰‡é©ç”¨ä¸­: fs_write å®Ÿè¡Œå‰ãƒã‚§ãƒƒã‚¯å®Œäº†
```

### æ–¹æ³•3: å®Ÿéš›ã®ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œç¢ºèª

```bash
# Q CLI chatã‚’èµ·å‹•
q chat

# Chatä¸­ã§ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆã‚’ä¾é ¼
# ã€Œãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ã€

# æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ:
# âœ“ 3 of 3 hooks finished in 0.08 s
# ðŸ” ä½œæ¥­åŽŸå‰‡é©ç”¨ä¸­: fs_write å®Ÿè¡Œå‰ãƒã‚§ãƒƒã‚¯å®Œäº†
```

---

## ä½¿ç”¨æ–¹æ³•

### é€šå¸¸ã®Chatä½¿ç”¨

```bash
# Q CLIã‚’èµ·å‹•
q chat

# é€šå¸¸é€šã‚ŠChatä½¿ç”¨
# é‡è¦ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œæ™‚ã«è‡ªå‹•çš„ã«ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹
```

### Hookå®Ÿè¡Œæ™‚ã®è¡¨ç¤ºä¾‹

```
é‡è¦ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œæ™‚:
âœ“ 3 of 3 hooks finished in 0.08 s
ðŸ” ä½œæ¥­åŽŸå‰‡é©ç”¨ä¸­: fs_write å®Ÿè¡Œå‰ãƒã‚§ãƒƒã‚¯å®Œäº†

[ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œç¶™ç¶š]
```

### ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®åŠ¹æžœ

- æŽ¨æ¸¬è¡¨ç¾ã®å›žé¿
- ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ç¢ºèªã®å¾¹åº•
- å®Ÿè£…æ¤œè¨¼ã®å®Ÿæ–½
- å“è³ªé‡è¦–ã®ä½œæ¥­ç¶™ç¶š

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### å•é¡Œ1: Hookè¨­å®šãŒå‹•ä½œã—ãªã„

**ç—‡çŠ¶**:
```
Chatä¸­ã§ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œæ™‚ã«ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œãªã„
```

**åŽŸå› **: Agentè¨­å®šã®hooksã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ãªã„

**è§£æ±ºç­–**:
```bash
# è¨­å®šç¢ºèª
jq '.hooks.preToolUse' ~/.aws/amazonq/cli-agents/default.json

# è¨­å®šãŒç©ºã®å ´åˆã¯æ‰‹å‹•ã§è¿½åŠ 
# Agentè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç›´æŽ¥ç·¨é›†
```

### å•é¡Œ2: ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œæ¨©é™ã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**:
```
bash: /home/user/.local/bin/smart-work-principles-check: Permission denied
```

**åŽŸå› **: ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«å®Ÿè¡Œæ¨©é™ãŒãªã„

**è§£æ±ºç­–**:
```bash
chmod +x ~/.local/bin/smart-work-principles-check
```

### å•é¡Œ3: ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒé©ç”¨ã•ã‚Œãªã„

**ç—‡çŠ¶**:
```
ä½œæ¥­åŽŸå‰‡ãŒé©ç”¨ã•ã‚Œã¦ã„ãªã„å‹•ä½œ
```

**åŽŸå› **: Agentè¨­å®šã§promptãŒæŒ‡å®šã•ã‚Œã¦ã„ãªã„

**è§£æ±ºç­–**:
```bash
# promptè¨­å®šã®ç¢ºèª
jq '.prompt' ~/.aws/amazonq/cli-agents/default.json

# è¨­å®šã•ã‚Œã¦ã„ãªã„å ´åˆã¯è¿½åŠ 
# "prompt": "file:///home/user/.amazonq/rules/system-prompt.md"
```

---

## ã¾ã¨ã‚

### ã‚·ã‚¹ãƒ†ãƒ ã®åˆ©ç‚¹

- âœ… **ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆçµ±åˆ**: Q CLIæ¨™æº–æ©Ÿèƒ½ã‚’æ´»ç”¨
- âœ… **éžã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–**: ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å‹•ä½œ
- âœ… **è»½é‡**: å¹³å‡0.08ç§’ã§é«˜é€Ÿå‹•ä½œ
- âœ… **é¸æŠžçš„**: é‡è¦ãƒ„ãƒ¼ãƒ«ã®ã¿å¯¾è±¡
- âœ… **ä¿å®ˆæ€§**: ã‚·ãƒ³ãƒ—ãƒ«ãªæ§‹æˆã§ç®¡ç†å®¹æ˜“

### å‹•ä½œç¢ºèªæ¸ˆã¿ç’°å¢ƒ

- **OS**: Ubuntu 24.04.3 LTS (WSL2)
- **Q CLI**: v1.19.0
- **å®Ÿè£…æ—¥**: 2025-10-27
- **æœ€çµ‚å‹•ä½œç¢ºèª**: 2025-10-28 02:35

### ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§

1. `~/.amazonq/rules/system-prompt.md` - ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
2. `~/.aws/amazonq/cli-agents/default.json` - Agentè¨­å®šï¼ˆpreToolUse hooksè¿½åŠ ï¼‰
3. `~/.local/bin/smart-work-principles-check` - Hook ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

---

**ä½œæˆè€…**: Amazon Q Developer CLI  
**ä½œæˆæ—¥æ™‚**: 2025-10-28 00:23 JST  
**æ›´æ–°æ—¥æ™‚**: 2025-10-28 02:35 JST  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… å®Ÿè£…å®Œäº†ãƒ»å‹•ä½œç¢ºèªæ¸ˆã¿
