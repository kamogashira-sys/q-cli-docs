# Q CLI ドキュメント品質保証プロセス

作成日: 2025-10-09  
最終更新: 2025-10-09 19:09 JST

## 目的

Q CLIドキュメントと実装の整合性を維持し、誤りの再発を防止する。

---

## 🎯 検証可能性の原則（2025-10-09追加）

### 基本原則

**すべての事実記述は検証可能でなければならない**

1. **コマンド出力例**: 実際にコマンドを実行して確認すること
2. **エラーメッセージ**: エラー条件を再現して確認すること
3. **設定ファイル例**: 実際の設定ファイルと照合すること
4. **動作説明**: 実際に操作して動作を確認すること
5. **デフォルト値**: ソースコードで確認すること

### 検証不可能な記述の扱い

検証不可能な記述（推測、想定）は以下のように明示すること：
- 「想定される動作」
- 「推奨される設定」
- 「一般的な使用例」

**禁止事項**: 検証せずに事実として記載すること

---

## 検証対象の定義

### P0（最優先）- 即座に検証が必要

| カテゴリ | 説明 | 検証方法 | リスク |
|---------|------|---------|--------|
| **コマンド出力例** | `q agent list`などの実行結果 | 実際にコマンド実行 | 実装変更で出力形式が変わる |
| **エラーメッセージ** | エラー発生時の表示内容 | エラー条件を再現 | 実装変更でメッセージが変わる |

### P1（高優先）- 早期に検証が必要

| カテゴリ | 説明 | 検証方法 | リスク |
|---------|------|---------|--------|
| **設定ファイル例** | settings.json、agent.jsonの記載例 | 実際の設定ファイル確認 | 項目追加・削除で不整合 |
| **動作説明** | 「～すると～になる」形式の記述 | 実際に動作確認 | 実装変更で動作が変わる |

### P2（中優先）- 計画的に検証

| カテゴリ | 説明 | 検証方法 | リスク |
|---------|------|---------|--------|
| **デフォルト値** | 設定項目のデフォルト値 | ソースコード確認 | 実装変更でデフォルト値が変わる |
| **ファイルパス** | 設定ファイルの配置場所 | 実際のパス確認 | OS依存、バージョン依存 |

---

## 検証方法の標準化

### 1. コマンド出力例の検証

**手順**:
1. ドキュメントに記載されているコマンドを特定
2. 実際にコマンドを実行
3. 出力をキャプチャ
4. ドキュメント記載と比較
5. 差異があれば記録

**検証項目**:
- 出力形式（ヘッダー、箇条書き、インデント）
- 出力内容（テキスト、数値、パス）
- 注釈の有無
- 表示順序

### 2. エラーメッセージの検証

**手順**:
1. ドキュメントに記載されているエラーメッセージを特定
2. エラー条件を再現
3. 実際のエラーメッセージを確認
4. ドキュメント記載と比較

### 3. 設定ファイル例の検証

**手順**:
1. ドキュメントに記載されている設定例を特定
2. 実際の設定ファイルと照合、または設定を適用して動作確認
3. ドキュメント記載と比較

### 4. 動作説明の検証

**手順**:
1. ドキュメントに記載されている動作説明を特定
2. 実際に操作を実行
3. 動作を確認
4. ドキュメント記載と比較

### 5. デフォルト値の検証

**手順**:
1. ドキュメントに記載されているデフォルト値を特定
2. ソースコードで確認、または設定なしで動作確認
3. ドキュメント記載と比較

---

## 検証記録の義務化

### トレーサビリティの確保

すべての事実記述には以下の検証記録を紐付けること：

1. **検証日時**: いつ検証したか
2. **検証方法**: どのように検証したか
3. **検証結果**: 一致/不一致/部分一致
4. **検証者**: 誰が検証したか

### 検証記録の保存場所

- 定期検証: `~/q-cli-work/verification-results/`
- 個別検証: ドキュメントのコミットメッセージに記載

---

## 定期照合プロセス

### 実施頻度

- **月次**: 環境変数と設定項目の照合
- **四半期**: 全ドキュメントの包括的レビュー
- **リリース前**: 新機能追加時の必須確認

### 照合対象

1. 環境変数（22項目）
2. 設定項目（35項目）
3. ファイルパス（5ファイル）

## チェックリストの活用

### 利用可能なチェックリスト

1. **環境変数確認用**: `~/q-cli-work/checklists/env-vars-checklist.md`
   - 推奨時間: 14分
   - 5ステップ

2. **設定項目確認用**: `~/q-cli-work/checklists/settings-checklist.md`
   - 推奨時間: 7分
   - 3ステップ

3. **ファイルパス確認用**: `~/q-cli-work/checklists/file-paths-checklist.md`
   - XDG仕様確認

### 実施タイミング

- 新規環境変数追加時
- 新規設定項目追加時
- ファイルパス変更時
- ドキュメント更新時

## 品質基準

### 必須要件

- [ ] 実装とドキュメントの整合性100%
- [ ] 環境変数の正確なカウント
- [ ] 設定項目の正確なカウント
- [ ] ファイルパスの正確性

### 推奨要件

- [ ] チェックリストの完全実施
- [ ] 作業ログの記録
- [ ] レビュー結果の文書化

## 新機能追加時のプロセス

### 環境変数追加時

1. 実装に環境変数を追加
2. `docs/user-guide/03_configuration/environment-variables.md`を更新
3. `docs/user-guide/03_configuration/environment-variables.md`を更新
4. 環境変数確認用チェックリストを実施

### 設定項目追加時

1. Setting enumに項目を追加
2. `docs/07_reference/settings-reference.md`を更新
3. 設定項目確認用チェックリストを実施

## 参考資料

- 実装詳細計画書: `~/ai-plan/20251009/202510091406-implementation-plan.md`
- 品質向上対策案: `~/ai-work/20251009/202510091357-quality-improvement-plan.md`
- 最終報告書: `~/ai-work/20251009/202510091440-final-report.md`
