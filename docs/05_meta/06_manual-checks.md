[ホーム](../README.md) > [Meta](README.md) > 手動検証プロセス

---

# 手動検証プロセス

自動化できない項目を人間が確認する**4つのチェックリスト**を説明します。

---

## なぜ手動チェックが必要か

自動化ツールは、機械的にチェックできる項目（ファイル数、日付、環境変数名等）には有効ですが、以下は人間の判断が必要です：

- **実装照合**: ソースコードと一致するか
- **動作確認**: 実際に動くか
- **削除操作**: 安全に削除できるか
- **文書品質**: 読みやすいか

---

## 1. 実装照合チェックリスト

### 目的

ドキュメントの内容がソースコードと完全に一致することを確認する。

---

### チェック項目（15項目）

#### ソースコード確認（6項目）

- [ ] **対象機能のソースコードを特定**
  ```bash
  rg "機能名" --type rust
  ```

- [ ] **設定項目の定義を確認**
  ```bash
  rg "struct.*Config" --type rust
  ```

- [ ] **プロパティ名を確認**
  ```bash
  rg "#\[serde\(rename" --type rust
  ```

- [ ] **デフォルト値を確認**
  ```bash
  rg "impl Default for" --type rust
  ```

- [ ] **環境変数の定義を確認**
  ```bash
  rg "define_env_vars!" --type rust
  ```

- [ ] **環境変数の使用箇所を確認**
  ```bash
  rg "ENV_VAR" --type rust
  ```

---

#### テストコード確認（4項目）

- [ ] **テストファイルを特定**
  - tests/ディレクトリを確認

- [ ] **設定例を確認**
  - テスト内の設定例を参照

- [ ] **期待される動作を確認**
  - assertionを確認

- [ ] **エッジケースを確認**
  - 境界値テストを確認

---

#### JSON Schema確認（5項目）

- [ ] **スキーマファイルを確認**
  ```bash
  cat schemas/agent-v1.json | jq '.properties'
  ```

- [ ] **必須フィールドを確認**
  ```bash
  cat schemas/agent-v1.json | jq '.required'
  ```

- [ ] **フィールドの型を確認**
  ```bash
  cat schemas/agent-v1.json | jq '.properties.fieldName.type'
  ```

- [ ] **デフォルト値を確認**
  ```bash
  cat schemas/agent-v1.json | jq '.properties.fieldName.default'
  ```

- [ ] **説明を確認**
  ```bash
  cat schemas/agent-v1.json | jq '.properties.fieldName.description'
  ```

---

### 実践例

**例**: 環境変数のドキュメントを作成する場合

```bash
# 1. ソースコードで定義を確認
rg "Q_LOG_LEVEL" --type rust

# 2. デフォルト値を確認
rg "impl Default" --type rust -A 10 | grep -i log_level

# 3. 使用箇所を確認
rg "Q_LOG_LEVEL" --type rust -C 3
```

---

## 2. 動作確認チェックリスト

### 目的

実際に動作することを確認する。

---

### チェック項目（12項目）

#### コマンド実行（4項目）

- [ ] **コマンドを実行**
  ```bash
  q chat "test command"
  ```

- [ ] **出力を確認**
  - 期待通りの出力か

- [ ] **エラーがないことを確認**
  - エラーメッセージが出ないか

- [ ] **終了コードを確認**
  ```bash
  echo $?
  ```

---

#### 設定ファイル適用（4項目）

- [ ] **設定ファイルを作成**
  ```bash
  cat > test-config.json << EOF
  {
    "name": "test-agent"
  }
  EOF
  ```

- [ ] **設定ファイルを適用**
  ```bash
  export Q_AGENT_CONFIG=/tmp/test-config.json
  q chat "test"
  ```

- [ ] **設定が反映されることを確認**
  - 期待通りの動作か

- [ ] **設定ファイルを削除**
  ```bash
  rm test-config.json
  ```

---

#### エラーメッセージ確認（4項目）

- [ ] **エラー条件を再現**
  - 意図的にエラーを発生させる

- [ ] **エラーメッセージを確認**
  - 実際のメッセージを記録

- [ ] **ドキュメント記載と比較**
  - 一致するか確認

- [ ] **差異があれば修正**
  - ドキュメントを更新

---

### 実践例

**例**: Agent設定のドキュメントを作成する場合

```bash
# 1. 設定ファイルを作成
cat > /tmp/test-agent.json << EOF
{
  "name": "test-agent",
  "description": "Test agent"
}
EOF

# 2. 設定を適用
export Q_AGENT_CONFIG=/tmp/test-agent.json

# 3. 動作確認
q chat "test"

# 4. 設定が反映されることを確認
# （出力にtest-agentが表示されるか）

# 5. クリーンアップ
unset Q_AGENT_CONFIG
rm /tmp/test-agent.json
```

---

## 3. 削除操作チェックリスト

### 目的

安全に削除できることを確認する。

---

### チェック項目（10項目）

#### 削除前確認（4項目）

- [ ] **使用箇所を検索**
  ```bash
  grep -r "削除対象" docs/
  ```

- [ ] **環境変数の場合**
  ```bash
  ./scripts/search-env-var.sh 環境変数名
  ```

- [ ] **使用箇所数を確認**
  - 0件であることを確認

- [ ] **削除の影響範囲を確認**
  - 他のドキュメントへの影響

---

#### 削除実行（3項目）

- [ ] **削除を実行**
  ```bash
  git rm docs/削除するファイル
  ```

- [ ] **コミットメッセージを作成**
  - 削除理由を明記

- [ ] **レビューを依頼**
  - 他の人に確認してもらう

---

#### 削除後確認（3項目）

- [ ] **自動化ツールで検証**
  ```bash
  ./scripts/count-files.sh
  cd tools/verification
  python3 validators/v2_validator.py ../../docs
  ```

- [ ] **リンク切れがないことを確認**
  ```bash
  grep -r "削除したファイル名" docs/
  ```

- [ ] **問題なしを確認**
  - すべてのツールで警告なし

---

### 実践例

**例**: 環境変数のドキュメントを削除する場合

```bash
# 1. 使用箇所を検索
./scripts/search-env-var.sh Q_OLD_VAR

# 2. 使用箇所が0件であることを確認
# （出力: 使用箇所数: 0）

# 3. 削除実行
# （該当箇所を削除）

# 4. 自動化ツールで検証
./scripts/count-files.sh
cd tools/verification
python3 validators/v2_validator.py ../../docs

# 5. 問題なしを確認
# （警告: 0件）
```

---

## 4. 文書品質チェックリスト

### 目的

読みやすいドキュメントを保証する。

---

### チェック項目（21項目）

#### フォーマット統一（8項目）

- [ ] **ファイル末尾フォーマットが統一されているか**
  ```markdown
  ---
  
  **最終更新**: YYYY-MM-DD  
  **メンテナー**: ドキュメントチーム
  ```

- [ ] **パンくずリストが統一されているか**
  ```markdown
  [ホーム](../README.md) > [カテゴリ](README.md) > ファイル名
  
  ---
  ```

- [ ] **見出しレベルが適切か**
  - H1（#）: 1つのみ（ファイルタイトル）
  - H2（##）: セクション
  - H3（###）: サブセクション

- [ ] **区切り線（---）の使い方が統一されているか**
  - パンくずリストの後（必須）
  - 最終更新の前（必須）
  - セクション間（オプション）
  - 前後に空行を入れる

- [ ] **リンクフォーマットが統一されているか**
  ```markdown
  [リンクテキスト](ファイル名.md)
  ```

- [ ] **コードブロックが適切か**
  - 言語指定がある（```bash, ```json等）
  - インデントが正しい
  - 閉じタグがある

- [ ] **リストのインデントが統一されているか**
  - インデント: 2スペース
  - 記号: `-`を使用
  - 空行の使い方が統一

- [ ] **表（テーブル）のフォーマットが統一されているか**
  - ヘッダー行がある
  - 区切り行がある
  - 列数が一致

---

#### リンク整合性（3項目）

- [ ] **リンク切れがないか**
  ```bash
  grep -r "\[.*\](.*)" docs/ | grep "\.md"
  ```

- [ ] **リンク先が存在するか**
  - 各リンクを確認

- [ ] **相対パスが正しいか**
  - パスを確認

---

#### 表記統一（4項目）

- [ ] **用語が統一されているか**
  - 「Agent」vs「エージェント」

- [ ] **大文字・小文字が統一されているか**
  - 「Q CLI」vs「q cli」

- [ ] **日付形式が統一されているか**
  - 「2025-11-01」形式

- [ ] **コードブロックの言語指定があるか**
  - ```bash, ```json等

---

#### 日付整合性（2項目）

- [ ] **最終更新日が記載されているか**
  ```markdown
  **最終更新**: 2025-11-01
  ```

- [ ] **Git最終更新日と一致するか**
  ```bash
  ./scripts/check-dates.sh docs/
  ```

---

#### 専門用語（4項目）

- [ ] **専門用語に説明があるか**
  - 初出時に説明

- [ ] **略語が展開されているか**
  - 「MCP (Model Context Protocol)」

- [ ] **リンクが適切か**
  - 関連ドキュメントへのリンク

- [ ] **例が適切か**
  - 具体例がある

---

### 実践例

**例**: 新規ドキュメントの品質確認

```bash
# 1. リンク切れチェック
grep -r "\[.*\](.*)" docs/新規ドキュメント.md

# 2. 日付チェック
./scripts/check-dates.sh docs/新規ドキュメント.md

# 3. 表記確認
# （手動で確認）

# 4. 専門用語確認
# （手動で確認）
```

---

## チェックリストの使い方

### 新規ドキュメント作成時

1. **実装照合チェックリスト**を使用
2. **動作確認チェックリスト**を使用
3. **文書品質チェックリスト**を使用

---

### ドキュメント更新時

1. **実装照合チェックリスト**を使用（技術的内容を変更する場合）
2. **文書品質チェックリスト**を使用

---

### ドキュメント削除時

1. **削除操作チェックリスト**を使用

---

## 関連ドキュメント

- **[自動化ツール](05_automation-tools.md)** - scripts + tools/verification
- **[日常的な作業フロー](09_daily-workflow.md)** - 新規作成・更新・削除
- **[9つの作業原則](04_quality-principles.md)** - 品質を保つルール

---

最終更新: 2025-11-01
