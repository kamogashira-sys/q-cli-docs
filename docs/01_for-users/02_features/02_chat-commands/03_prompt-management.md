[ホーム](../../../README.md) > [ユーザーガイド](../../README.md) > [機能ガイド](../README.md) > [チャット機能](../01_chat.md) > プロンプト管理

---

# プロンプト管理

**対象バージョン**: v1.13.0以降

## 📋 コマンド概要

プロンプト管理機能は、再利用可能なプロンプトテンプレートの作成・管理と、エディタを使った長文プロンプトの作成を支援します。定型的な指示をテンプレート化することで、効率的なAI活用を実現できます。

## 🚀 基本的な使い方

### プロンプト管理コマンド一覧

| コマンド | 詳細説明 | 使用シーン |
|---------|---------|-----------|
| `/prompts [サブコマンド]` | 再利用可能なプロンプトテンプレートを作成・管理。よく使う指示をテンプレート化して `@プロンプト名` で呼び出し可能。ローカル保存とMCPサーバー提供の両方に対応。定型文、雛形、スニペット管理にも活用 | 定型的な指示を効率化したい時、チーム共通のプロンプトを管理したい時、複雑な指示をテンプレート化したい時 |
| `/editor [初期テキスト]` | $EDITORでプロンプトを作成（デフォルト: vi）。長文のプロンプトを使い慣れたエディタで編集可能 | 長いプロンプトを書く時、使い慣れたエディタで編集したい時、複数行のプロンプトを整理したい時 |

### 基本例

```bash
# 利用可能なプロンプト一覧を表示
/prompts

# プロンプトの詳細を確認
/prompts details code-review

# プロンプトを使用
@code-review

# エディタでプロンプト作成
/editor
```

## ⚙️ オプション・引数

### `/prompts` サブコマンド

| サブコマンド | 説明 | 使用例 |
|-------------|------|--------|
| `list [検索語]` | 利用可能なプロンプト一覧を表示 | `/prompts list code` |
| `details <名前>` | プロンプトの詳細情報を表示 | `/prompts details review` |
| `get <名前> [引数...]` | プロンプトを取得して使用 | `/prompts get review main.py` |
| `create -n <名前> [--content <内容>]` | 新しいプロンプトを作成 | `/prompts create -n my-prompt` |
| `edit <名前>` | 既存のプロンプトを編集 | `/prompts edit my-prompt` |
| `remove <名前>` | プロンプトを削除 | `/prompts remove my-prompt` |

### `/editor` コマンド

| 引数 | 説明 | 必須 |
|------|------|------|
| `[初期テキスト]` | エディタに初期表示するテキスト | いいえ |

**環境変数**:
- `$EDITOR`: 使用するエディタ（デフォルト: vi）
- 例: `export EDITOR=nano`, `export EDITOR=code`

### プロンプトの保存場所

| 場所 | パス | 用途 |
|------|------|------|
| **ローカル** | `.amazonq/prompts/` | プロジェクト固有のプロンプト |
| **グローバル** | `~/.aws/amazonq/prompts/` | 全プロジェクト共通のプロンプト |
| **MCPサーバー** | 外部サーバー | チーム共有・高度なプロンプト |

## 💡 実用例

### 例1: コードレビュー用プロンプトの作成と使用

**シナリオ**: チーム共通のコードレビュー基準をプロンプト化したい

```bash
# コードレビュー用プロンプトを作成
/prompts create -n code-review --content "以下のコードをレビューしてください。セキュリティ、パフォーマンス、可読性の観点から改善点を指摘し、具体的な修正案を提示してください。"

# プロンプトの確認
/prompts details code-review

# 実際の使用
@code-review
```

**ファイルを直接編集する場合**:
```bash
# プロンプトファイルを作成
mkdir -p .amazonq/prompts
cat > .amazonq/prompts/code-review.txt << 'EOF'
以下のコードをレビューしてください：

## チェック項目
1. セキュリティ脆弱性
2. パフォーマンスの問題
3. コードの可読性
4. ベストプラクティス準拠

## 出力形式
- 問題点: 具体的な指摘
- 修正案: 改善されたコード例
- 理由: なぜその修正が必要か
EOF

# プロンプトを使用
@code-review
```

**結果**: 一貫したコードレビューが効率的に実行できる

### 例2: 引数付きプロンプトでテスト生成

**シナリオ**: 複数の言語でユニットテスト生成を自動化したい

```bash
# 引数付きプロンプトを作成
/prompts create -n test-gen --content "{{language}}言語で{{function_name}}関数のユニットテストを作成してください。エッジケース、正常ケース、異常ケースを含めてください。"

# Python用テストの生成
/prompts get test-gen Python calculate_total

# JavaScript用テストの生成
/prompts get test-gen JavaScript validateEmail
```

**高度な引数付きプロンプト例**:
```bash
# ファイルで作成
cat > .amazonq/prompts/api-doc.txt << 'EOF'
{{api_type}} APIの{{endpoint}}エンドポイントについて、以下の形式でドキュメントを作成してください：

## エンドポイント
- URL: {{endpoint}}
- メソッド: {{method}}

## 説明
{{description}}

## パラメータ
- 必須パラメータ
- オプションパラメータ

## レスポンス例
- 成功時
- エラー時

## 使用例
curl コマンドとコード例を含めてください。
EOF

# 使用例
/prompts get api-doc REST "/users/{id}" GET "ユーザー情報を取得する"
```

**結果**: 言語やAPIに応じて柔軟にドキュメントを生成できる

### 例3: エディタを使った複雑なプロンプト作成

**シナリオ**: 長文の技術仕様書レビュー用プロンプトを作成したい

```bash
# エディタを起動してプロンプト作成
/editor "技術仕様書をレビューしてください"

# エディタ内で詳細なプロンプトを作成
# （viやnanoなどで編集）

# 作成したプロンプトをテンプレート化
/prompts create -n spec-review
```

**エディタで作成するプロンプト例**:
```
技術仕様書を以下の観点から詳細にレビューしてください：

## アーキテクチャ設計
- システム全体の整合性
- スケーラビリティの考慮
- セキュリティ要件の充足

## 技術選定
- 技術スタックの妥当性
- パフォーマンス要件への対応
- 保守性・拡張性の考慮

## 実装計画
- 開発スケジュールの現実性
- リスク要因の特定
- テスト戦略の妥当性

## 出力形式
各項目について以下の形式で回答してください：
- 評価: 良好/要改善/問題あり
- 理由: 具体的な根拠
- 提案: 改善案（該当する場合）
```

**結果**: 複雑で構造化されたプロンプトを効率的に作成・管理できる

## 🔧 トラブルシューティング

### よくある問題

#### 問題1: プロンプトが見つからない

**症状**: `@プロンプト名` や `/prompts get` でプロンプトが見つからない

**原因**: ファイル名の間違い、または保存場所の問題

**解決策**:
```bash
# 利用可能なプロンプト一覧を確認
/prompts list

# ファイルの存在確認
ls .amazonq/prompts/
ls ~/.aws/amazonq/prompts/

# ファイル名を確認
find . -name "*.txt" -path "*/.amazonq/prompts/*"
```

#### 問題2: プロンプトを作成できない

**症状**: `/prompts create` でエラーが発生する

**原因**: ディレクトリの権限問題、またはディスク容量不足

**解決策**:
```bash
# ディレクトリを手動作成
mkdir -p .amazonq/prompts
mkdir -p ~/.aws/amazonq/prompts

# 権限を確認
ls -la .amazonq/
ls -la ~/.aws/amazonq/

# ディスク容量を確認
df -h
```

#### 問題3: MCPプロンプトが表示されない

**症状**: MCPサーバーのプロンプトが `/prompts list` に表示されない

**原因**: MCPサーバーの接続問題、または設定の問題

**解決策**:
```bash
# MCPサーバーの状態を確認
/mcp

# MCPサーバーを再起動
/quit
q chat

# MCP設定を確認
cat .amazonq/mcp.json
```

#### 問題4: エディタが起動しない

**症状**: `/editor` でエディタが起動しない、または意図しないエディタが起動する

**原因**: `$EDITOR` 環境変数の設定問題

**解決策**:
```bash
# 現在のエディタ設定を確認
echo $EDITOR

# エディタを設定
export EDITOR=nano
export EDITOR=code
export EDITOR=vim

# 設定を永続化
echo 'export EDITOR=nano' >> ~/.bashrc
source ~/.bashrc
```

#### 問題5: 引数付きプロンプトが正しく展開されない

**症状**: `{{variable}}` が置換されない、または構文エラーが発生

**原因**: 引数の記述形式の問題、または引数の不足

**解決策**:
```bash
# プロンプトの内容を確認
/prompts details test-gen

# 正しい引数形式で実行
/prompts get test-gen "Python" "calculate_sum"

# 引数なしで実行して確認
/prompts get test-gen
```

## 🔗 関連コマンド

- [コンテキスト管理](02_context-management.md) - `/context`によるファイル管理との連携
- [基本コマンド・会話管理](01_basic-commands.md) - `/save`、`/load`による会話の保存
- [開発者向けコマンド](08_developer-commands.md) - `/mcp`によるMCPサーバー管理

## 📖 参照元

- [チャット機能概要](../01_chat.md#プロンプト管理) - プロンプト管理の概要
- [コンテキスト管理ベストプラクティス](../../08_guides/04_best-practices.md) - 効果的なプロンプト作成方法

---

最終更新: 2025年11月13日
